import{_ as s,j as l,k as n,S as a}from"./chunks/framework.2ff57350.js";const p=JSON.parse('{"title":"Mac 定时任务","description":"","frontmatter":{},"headers":[],"relativePath":"note/mac-launchctl-task.md","filePath":"note/mac-launchctl-task.md"}'),t={name:"note/mac-launchctl-task.md"},o=[a('<h1 id="mac-定时任务" tabindex="-1">Mac 定时任务 <a class="header-anchor" href="#mac-定时任务" aria-label="Permalink to &quot;Mac 定时任务&quot;">​</a></h1><h2 id="用途" tabindex="-1"><strong>用途</strong> <a class="header-anchor" href="#用途" aria-label="Permalink to &quot;**用途**&quot;">​</a></h2><ul><li>每天重复的工作写成脚本</li><li>定时提醒吃饭</li><li>定时下班关机</li><li>定时自己写周报</li><li>定时打开页面签到</li><li>定时开启启动IDE和服务</li><li>每天早安晚安</li><li>...</li></ul><h2 id="设置方法" tabindex="-1"><strong>设置方法</strong> <a class="header-anchor" href="#设置方法" aria-label="Permalink to &quot;**设置方法**&quot;">​</a></h2><ol><li><a href="https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/crontab.html" target="_blank" rel="noreferrer">crontab</a></li><li>launchctl</li></ol><p>官方推荐的为第二种方式，支持和友好性也更倾向于第二种。</p><p>本文主要介绍第二种方式的使用</p><div class="language-shell"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># 加载命令</span></span>\n<span class="line"><span style="color:#FFCB6B;">launchctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">load</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">xxx.plist</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;"># 退出加载命令</span></span>\n<span class="line"><span style="color:#FFCB6B;">launchctl</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">unload</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">xxx.plist</span></span></code></pre></div><p><strong>Plist 文件配置</strong></p><p><strong>Mac OS X 中支持放 plist 的目录如下：</strong></p><ul><li>/Library/LaunchDaemons: 系统启动后就会执行</li><li>/Library/LaunchAgents: 当用户登录系统后才会执行</li><li>~/Library/LaunchAgents: 用户自定义的 plist</li><li>/System/Library/LaunchAgents: 由 Mac OS X 为用户定义的任务</li><li>/System/Library/LaunchDaemons: 由 Mac OS X 定义的守护进程任务</li></ul><p><strong>功课准备好开始</strong></p><ol><li>在对应权限的目录新建<code>.plist</code>配置文件</li><li>使用加载命令加载定时任务配置文件</li></ol><p><strong>大多数配置都集中在plist文件，plist文件的配置细分来讲</strong></p><div class="language-xml"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UTF-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;!</span><span style="color:#F78C6C;">DOCTYPE</span><span style="color:#89DDFF;"> </span><span style="color:#A6ACCD;">plist</span><span style="color:#89DDFF;"> PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</span><span style="color:#A6ACCD;"> </span></span>\n<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">plist</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">dict</span><span style="color:#89DDFF;">&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;">&lt;!--Plist 名称，必须唯一--&gt;</span><span style="color:#A6ACCD;"> </span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">Label</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">string</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">com.zh.task</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">string</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;">&lt;!-- 指定要运行的程序的名称，可以是一个程序或者是一段脚本 数组类型 --&gt;</span><span style="color:#A6ACCD;">   </span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">ProgramArguments</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">array</span><span style="color:#89DDFF;">&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">string</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">/Users/zh/Desktop/task.sh</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">string</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">array</span><span style="color:#89DDFF;">&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;">&lt;!--</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">   \t\t\t\t\t\t在 Plist 中，支持两种定时任务的设置：</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">              StartInterval：定义任务多长时间（单位，秒）执行一次</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">              StartCalendarInterval：这个配置类似在 crontab 中的配置，</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">              指定具体的执行日期、星期、每月、每日的各个时间点，</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">              具体参照上面的配置文件。月份和天数的配置类似。</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">        &lt;key&gt;StartInterval&lt;/key&gt;</span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">        &lt;integer&gt;3600&lt;/integer&gt; </span></span>\n<span class="line"><span style="color:#676E95;font-style:italic;">        --&gt;</span><span style="color:#A6ACCD;"> </span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;">&lt;!-- 执行时间的指定 --&gt;</span><span style="color:#A6ACCD;"> </span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">StartCalendarInterval</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">dict</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span></span>\n<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;font-style:italic;">&lt;!--在第几分钟会被执行 --&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">Minute</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">integer</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">00</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">integer</span><span style="color:#89DDFF;">&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#676E95;font-style:italic;">&lt;!-- 在第几个小时会被执行--&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">Hour</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span></span>\n<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">integer</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">22</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">integer</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">dict</span><span style="color:#89DDFF;">&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;">&lt;!-- 运行日志 --&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">StandardOutPath</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;">&lt;!-- 日志路径 --&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">string</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">/path/xxxx.log</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">string</span><span style="color:#89DDFF;">&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;">&lt;!-- 错误日志 --&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">StandardErrorPath</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">key</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;">&lt;!-- 日志路径 --&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">string</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">/path/xxxx.err</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">string</span><span style="color:#89DDFF;">&gt;</span></span>\n<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">dict</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span></span>\n<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">plist</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div>',15)];const e=s(t,[["render",function(s,a,p,t,e,c){return l(),n("div",null,o)}]]);export{p as __pageData,e as default};
